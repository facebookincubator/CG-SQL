#!/bin/bash
# Copyright (c) Facebook, Inc. and its affiliates.
#
# This source code is licensed under the MIT license found in the
# LICENSE file in the root directory of this source tree.


pushd ..
make clean && make
popd

../out/cql --in dbhelp.sql --cg dbhelp.h dbhelp.c

sed -e "/autogenerated/d" \
    -e "/generated SignedSource/d" \
    -e "/(c).*Facebook/d" <dbhelp.c >dbhelp.c2

sed -e "/autogenerated/d" \
    -e "/generated SignedSource/d" \
    -e "/(c).*Facebook/d" <dbhelp.h >dbhelp.h2

(cat <<EOF; cat dbhelp.c2) >dbhelp.c
/*
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
EOF

(cat <<EOF; cat dbhelp.h2) >dbhelp.h
/*
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
EOF

rm dbhelp.h2 dbhelp.c2
